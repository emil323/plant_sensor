name: Arduino CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  compile:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Setup Arduino CLI
      uses: arduino/setup-arduino-cli@v1
      
    - name: Install Arduino AVR core
      run: arduino-cli core install arduino:avr
      
    - name: Install HX711 library
      run: arduino-cli lib install HX711
      
    - name: Compile sketch
      run: |
        arduino-cli compile --fqbn arduino:avr:pro:cpu=8MHzatmega328 \
          --warnings all \
          plant_weight_sensor.ino
          
    - name: Report compilation results
      run: |
        echo "### âœ… Compilation Results" >> $GITHUB_STEP_SUMMARY
        echo "Sketch compiled successfully for Arduino Pro Mini 8MHz (ATmega328P)" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "**Target Board:** Arduino Pro Mini 3.3V 8MHz" >> $GITHUB_STEP_SUMMARY
        echo "**Processor:** ATmega328P" >> $GITHUB_STEP_SUMMARY
        echo "**Clock Speed:** 8MHz" >> $GITHUB_STEP_SUMMARY
